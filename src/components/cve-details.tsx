'use client';

import { useState } from 'react';
import { Badge } from './ui/badge';
import { ChevronDown, ChevronUp, ExternalLink } from 'lucide-react';
import { Button } from './ui/button';

interface CveDetailsProps {
  cveId: string;
  allCves?: string[];
}

export function CveDetails({ cveId, allCves = [] }: CveDetailsProps) {
  const [isExpanded, setIsExpanded] = useState(false);
  
  return (
    <div className="space-y-2">
      <div className="flex items-center gap-2">
        <a 
          href={`https://nvd.nist.gov/vuln/detail/${cveId}`} 
          target="_blank" 
          rel="noopener noreferrer"
          className="text-destructive hover:underline flex items-center gap-1"
        >
          {cveId}
          <ExternalLink className="h-3 w-3" />
        </a>
        
        {allCves.length > 1 && (
          <Button 
            variant="ghost" 
            size="sm" 
            className="h-6 px-2 text-xs text-muted-foreground"
            onClick={() => setIsExpanded(!isExpanded)}
          >
            {isExpanded ? (
              <>
                Show less
                <ChevronUp className="ml-1 h-3 w-3" />
              </>
            ) : (
              <>
                +{allCves.length - 1} more
                <ChevronDown className="ml-1 h-3 w-3" />
              </>
            )}
          </Button>
        )}
      </div>
      
      {isExpanded && (
        <div className="ml-4 space-y-1">
          {allCves.slice(1).map((cve) => (
            <div key={cve} className="flex items-center gap-2">
              <a 
                href={`https://nvd.nist.gov/vuln/detail/${cve}`} 
                target="_blank" 
                rel="noopener noreferrer"
                className="text-xs text-muted-foreground hover:underline flex items-center gap-1"
              >
                {cve}
                <ExternalLink className="h-3 w-3" />
              </a>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}
